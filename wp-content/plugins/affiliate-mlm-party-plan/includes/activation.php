<?php$db = new \AffiliateUsers\Includes\DB();register_activation_hook(AFFILIATE_USERS_PAGE, array($db, 'createTable'));register_activation_hook(AFFILIATE_USERS_PAGE, 'ampp_affiliate_activation');function ampp_affiliate_activation() {    if (! wp_next_scheduled ( 'synchronize_affiliates_event' )) {        wp_schedule_event(time(), 'hourly', 'synchronize_affiliates_event');    }}add_action('synchronize_affiliates_event', 'ampp_synchronize_affiliates');function ampp_synchronize_affiliates() {    $api_affiliates = get_affiliates('', '', '', '', '', '');    $db = new \AffiliateUsers\Includes\DB();    $args = array ( 'per_page' => -1 );    $db_affiliates = $db->getUsersByArgs($args);    $db_affiliate_usernames = array();        foreach ($db_affiliates as $affiliate) {        $db_affiliate_usernames[$affiliate->username] = true;    }    foreach ($api_affiliates as $affiliate) {        $db = new AffiliateUsers\Includes\DB();        if (!isset($db_affiliate_usernames[$affiliate->Username])) {            $name = $affiliate->FirstName . ' ' . $affiliate->LastName;            $db->addUser(array(                    'affiliate_id' => $affiliate->AffiliateId,                    'username' => $affiliate->Username,                    'name' => $name,                )            );        }    }}